---
title: "Analyzing the impact of low voter turnout on the outcome of the 2019 Canadian Federal Election"
subtitle: "A multi-level regression and post-stratification analysis"
author: "Author Redacted"
date: "December 21st, 2020"
abstract: "My abstract goes here. Keywords: MRP, elections, voter turnout, surveys."
output:
  bookdown::pdf_document2:
    citation_package: natbib
    toc: false
    number_sections: false 
    nocite: '@*'
bibliography: PS4refs.bib
biblio-style: "apalike"
---
\pagenumbering{gobble}
\begin{center}
Code supporting this analysis can be found at: https://github.com/ 
\end{center}
```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

library(tidyverse)
library(jtools) #Create plots and tables for regression models
library(ggplot2) #Create plots and diagrams
library(huxtable) #Make tables
library(lme4)

# Loading in the cleaned survey Data
CES_data <- read_csv("CES_data.csv")

# Loading in the cleaned census Data
censusdata <- read_csv("censusdata.csv")
```
# Introduction

For most advanced democracies across the world, many citizens do not participate in the democratic process, and those who turn out to vote are usually unrepresentative of the eligible voting population [@fowler_five_2013]. While many argue that the right to abstention is equally important as the ability to vote, low voter turnout can can lead to unequal political representation across the population, often for young voters of lower socioeconomic status [@uppal_factors_2012].

In Canada, voter turnout rates range from 60 to 70% , however, this has been on decline in the last 20 years [@rubenson_does_2007]. Low voter turnout most commonly occurs among youth, and their low participation is believed to drive party bias towards the Conservative party in past federal elections [@grenier_how_2019].

This analysis will examine whether levels of voter turnout have implications in Canadian election results. To do so, we employ a multi-level regression and post-stratification (MRP) technique to estimate the probability of voting for each of the major 6 parties based for a population representative to Canada's demographics. Two data sets will be used to first derive models that estimate voter intent based on demographic characteristics, then to predict the election outcome of voters on a post-stratified census dataset.

# Methods

This analysis uses polling survey data from the 2019 Canadian Election Survey [@stephenson_2019_2020], accessed through the cesR R package [@cesR]. We then employ a post-stratification technique to estimate the proportion of voters for each candidate at a national scale to determine the popular vote, then at the provincial scale to determine the outcome of the votes. All data cleaning, modeling, and calculations are carried out using R statistical language [@citeR] and the tidyverse and lme4 packages [@citeTidy; @citelme4]. The model specifics and post-stratification calculations are described in subsequent sections.

## Data
Here I will describe the data sources used.

## Variables and data cleaning 

To aggregate the variables into meaningful groups and to ensure that the survey data corresponds to census data, each variable was reclassified into new categories. We chose the factors of sex, age, province, and education level. Age was aggregated into 4 groups: 18-29, 30-44, 45-60, and 60+ and subjects under 18 were filtered out. Education level was categorized into 4 groups: less than high school, high school graduate, some college, and college graduate.

## Model Specifics

Here I will discuss the model, and provide the equations.

```{r models, echo=FALSE, include = FALSE}
# Creating the Model
#Vote for Libs
modelLiberal <- glmer(as.factor(vote_Liberal) ~ as.factor(sex) +
                        as.factor(age_group) + 
                        as.factor(education_group) + 
                        (1|province),
                     data = CES_data, 
                     family = binomial)

#summary(modelLiberal)
 
#Vote for Cons
modelConservative <- glmer(as.factor(vote_Conservative) ~ as.factor(sex) +
                        as.factor(age_group) + 
                        as.factor(education_group) + 
                        (1|province),
                     data = CES_data, 
                     family = binomial)

#summary(modelConservative)

#Vote for NDP
modelNDP <- glmer(as.factor(vote_NDP) ~ as.factor(sex) +
                        as.factor(age_group) + 
                        as.factor(education_group) + 
                        (1|province),
                     data = CES_data, 
                     family = binomial)

#summary(modelNDP)

#Vote for Green
modelGreen <- glmer(as.factor(vote_Green) ~ as.factor(sex) +
                        as.factor(age_group) + 
                        as.factor(education_group) + 
                        (1|province),
                     data = CES_data, 
                     family = binomial)

# summary(modelGreen)

#Vote for BQ
#modelBQ <- glmer(as.factor(vote_BQ) ~ as.factor(sex) +
 #                       as.factor(age_group) + 
  #                      as.factor(education_group) + 
   #                     (1|province),
    #                 data = CES_data, 
     #                family = binomial)

#summary(modelBQ)

#Vote for People's
modelPeoples <- glmer(as.factor(vote_Peoples) ~ as.factor(sex) +
                        as.factor(age_group) + 
                        as.factor(education_group) + 
                        (1|province),
                     data = CES_data, 
                     family = binomial)

# summary(modelPeoples)

```

## Post-Stratification 

Poststratification is a method frequently used to aggregate survey-level estimates to the population and correct for non-probability sampling [@little_post-stratification_1993; @wang_forecasting_2015]. With poststratification, estimation of the response variable arises from cell-level estimates that are partitioned into different combinations of variables, which are then aggregated up to a population level by weighting each cell by its relative proportion in the population [@wang_forecasting_2015]. In our analysis, we use post-stratification to estimate the proportion of voters that will vote for each of the 6 major federal parties in Canada. With the response variable, $\hat{y}^{PS}$ representing the national proportion of voters for each candidate, the post-stratification estimate is defined by

$$\hat{y}^{PS} = {\frac{\sum_{j=1}^{J} N_j\hat{y}_j}{\sum_{j=1}^{J} N_j}}$$  

where $\hat{y}_j$ is the estimated proportion of votes for a given party within cell $j$, and $N_j$ is the size of the $j^{th}$ cell in the population. 

```{r, echo=FALSE, include = FALSE}

# Here I will perform the post-stratification calculation

censusdata$logodds_Liberal <-
  modelLiberal %>%
  predict(newdata = censusdata)

censusdata$logodds_Conservative <-
  modelConservative %>%
  predict(newdata = censusdata)

censusdata$logodds_NDP <-
  modelNDP %>%
  predict(newdata = censusdata)

#censusdata$logodds_BQ <-
#  modelBQ %>%
#  predict(newdata = censusdata)

censusdata$logodds_Green <-
  modelGreen %>%
  predict(newdata = censusdata)

censusdata$logodds_Peoples <-
  modelPeoples %>%
  predict(newdata = censusdata)


censusdata$estimateLiberal <-
  exp(censusdata$logodds_Liberal)/(1+exp(censusdata$logodds_Liberal))

censusdata$estimateConservative <-
  exp(censusdata$logodds_Conservative)/(1+exp(censusdata$logodds_Conservative))

censusdata$estimateNDP <-
  exp(censusdata$logodds_NDP)/(1+exp(censusdata$logodds_NDP))

censusdata$estimateGreen <-
  exp(censusdata$logodds_Green)/(1+exp(censusdata$logodds_Green))

#censusdata$estimateBQ <- exp(censusdata$logodds_BQ)/(1+exp(censusdata$logodds_BQ))

censusdata$estimatePeoples <-
  exp(censusdata$logodds_Peoples)/(1+exp(censusdata$logodds_Peoples))

```


# Results
Here I will present the results of my analysis. 

```{r natest, echo=FALSE}
propLiberal = sum(censusdata$estimateLiberal*censusdata$n, na.rm = T)/sum(censusdata$n)
propCons = sum(censusdata$estimateConservative*censusdata$n, na.rm = T)/sum(censusdata$n)
propNDP = sum(censusdata$estimateNDP*censusdata$n, na.rm = T)/sum(censusdata$n)
propGreen = sum(censusdata$estimateGreen*censusdata$n, na.rm = T)/sum(censusdata$n)
#propBQ = sum(censusdata$estimateBQ*censusdata$n, na.rm = T)/sum(censusdata$n)
propPeoples = sum(censusdata$estimatePeoples*censusdata$n, na.rm = T)/sum(censusdata$n)

proportions = hux(
  "Party" = c("Liberal","Conservative", "NDP", "Green", #"BQ", 
              "People's Party"),
  "Proportion" = c(propLiberal, propCons, propNDP, propGreen, #propBQ, 
                   propPeoples)
) 
proportions %>% 
  set_bold(1, everywhere) %>% 
  set_bottom_border(1, everywhere) %>% 
  set_caption("Estimates of national proportion of voters for 2019 Canadian Election") %>% 
  set_caption_width(value = 20)

```

Our post-stratification calculations estimate that Liberals  will receive 0.26 of the federal vote (Table \@ref(tab:natest)).

# Discussion
Here I will discuss and provide interpretation of the results, then talk about weaknesses and next steps. 

## Weaknesses

## Next steps

# References